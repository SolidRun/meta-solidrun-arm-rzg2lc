From 4a1cae5fecdb1002de4fb377628d56fdb5060699 Mon Sep 17 00:00:00 2001
From: Mikhail Anikin <mikhail.anikin@solid-run.com>
Date: Thu, 28 Sep 2023 15:50:45 +0300
Subject: [PATCH] RZ/V2L: Add DRP-AI node

---
 arch/arm64/boot/dts/renesas/rzv2l-sr-som.dtsi | 20 ++++++++++++++-----
 1 file changed, 15 insertions(+), 5 deletions(-)

diff --git a/arch/arm64/boot/dts/renesas/rzv2l-sr-som.dtsi b/arch/arm64/boot/dts/renesas/rzv2l-sr-som.dtsi
index 382de34574cd..94462edf5655 100644
--- a/arch/arm64/boot/dts/renesas/rzv2l-sr-som.dtsi
+++ b/arch/arm64/boot/dts/renesas/rzv2l-sr-som.dtsi
@@ -67,11 +67,6 @@ image_buf0: image_buf@0 {
 					reg = <0x0 0xB0000000 0x0 0x04000000>;
 					label = "image_buf0";
 			};
-
-			isp_work0: SIMPLE_ISP {
-					reusable;
-					reg = <0x0 0xB4000000 0x0 0x03000000>;
-			};
 	};
 
 	mmngr {
@@ -87,6 +82,15 @@ vspm_if {
 		compatible = "renesas,vspm_if";
 	};
 
+	udmabuf@0 {
+		compatible = "ikwzm,u-dma-buf";
+		device-name = "udmabuf0";
+		minor-number = <0>;
+		size = <0x4000000>; // 64MiB
+		dma-coherent;
+		memory-region = <&image_buf0>;
+	};
+
 	reg_1p8v: regulator0 {
 		compatible = "regulator-fixed";
 		regulator-name = "fixed-1.8V";
@@ -558,3 +562,9 @@ &cru {
 &mtu3 {
 	status = "okay";
 };
+
+&drpai0 {
+	memory-region = <&drp_reserved>;
+	linux-memory-region = < &{/memory@48000000} >; 
+	status = "okay";
+};
-- 
2.41.0

